{% extends 'base.html.twig' %}

{% block title %}Food List (View Only){% endblock %}

{% block body %}
{% include 'navbar.html.twig' %}
    <div class="container mt-4">
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <h1 class="h3 mb-0">Food List</h1>
            </div>
            <div class="card-body">

                <div class="row" id="foodGrid">
                    {% for food in food %}
                        <div class="col-md-3 mb-4 food-card">
                            <div class="card h-100 border border-dark" style="font-family: Arial, Helvetica, sans-serif; background: #fff;">
                                <div class="card-body p-3" style="border:none;">
                                    <div style="border-bottom:8px solid #000; padding-bottom:0.5rem;">
                                        <h4 class="fw-bold mb-1" style="font-size:1.5rem; letter-spacing:-1px;">Nutrition Facts</h4>
                                        <div class="fw-bold" style="font-size:1.1rem;">{{ food.name }}</div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center fw-bold mt-2" style="font-size:1rem;">
                                        <span>Portion Size</span>
                                        <span>{{ food.grams }} g</span>
                                    </div>
                                    <div style="border-bottom:4px solid #000; margin:0.3rem 0;"></div>
                                    <div class="fw-bold" style="font-size:0.95rem;">Amount Per Portion</div>
                                    <div class="d-flex align-items-end" style="font-size:2rem; font-weight:bold;">
                                        <span>Calories</span>
                                        <span class="ms-auto" style="font-size:2.2rem;">{{ food.calories }}</span>
                                    </div>
                                    <div style="border-bottom:3px solid #000; margin:0.2rem 0 0.2rem 0;"></div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8 fw-bold">Total Fat</div>
                                        <div class="col-4 text-end">{{ food.fats }}g</div>
                                    </div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8 ps-3">Saturated Fat</div>
                                        <div class="col-4 text-end">{{ food.saturatedFats }}g</div>
                                    </div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8 fw-bold">Sodium</div>
                                        <div class="col-4 text-end">{{ food.sodium }}mg</div>
                                    </div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8 fw-bold">Total Carbohydrate</div>
                                        <div class="col-4 text-end">{{ food.carbohydrate }}g</div>
                                    </div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8 ps-3">Fibre</div>
                                        <div class="col-4 text-end">{{ food.fibre }}g</div>
                                    </div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8 ps-3">Sugar</div>
                                        <div class="col-4 text-end">{{ food.sugar }}g</div>
                                    </div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8 fw-bold">Protein</div>
                                        <div class="col-4 text-end">{{ food.protein }}g</div>
                                    </div>
                                    <div style="border-bottom:3px solid #000; margin:0.2rem 0 0.2rem 0;"></div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8">Cholesterol</div>
                                        <div class="col-4 text-end">{{ food.cholesterol }}mg</div>
                                    </div>
                                    <div class="row small g-0 mb-1">
                                        <div class="col-8">Magnesium</div>
                                        <div class="col-4 text-end">{{ food.magnesium }}mg</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <div class="col-12 text-center">
                            <p class="text-muted">No records found</p>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('foodSearch');
            const foodGrid = document.getElementById('foodGrid');
            const cards = foodGrid.getElementsByClassName('food-card');
            
            searchInput.addEventListener('keyup', function() {
                const searchText = searchInput.value.toLowerCase();
                
                for (let i = 0; i < rows.length; i++) {
                    const row = rows[i];
                    const cells = row.getElementsByTagName('td');
                    let found = false;
                    
                    // Skip the "no records found" row
                    if (cells.length === 1 && cells[0].getAttribute('colspan')) {
                        continue;
                    }
                    
                    // Check each cell in the row
                    for (let j = 0; j < cells.length; j++) {
                        const cellText = cells[j].textContent || cells[j].innerText;
                        if (cellText.toLowerCase().indexOf(searchText) > -1) {
                            found = true;
                            break;
                        }
                    }
                    
                    // Show/hide the row based on search result
                    row.style.display = found ? '' : 'none';
                }
            });
        });
    </script>
{% endblock %}
