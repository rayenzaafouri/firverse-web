{% extends 'base.html.twig' %}

{% block title %}Your Nutrition Plan{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .meal-card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }
        .meal-header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 15px;
            border-bottom: none;
        }
        .meal-body {
            padding: 20px;
        }
        .meal-table {
            margin-bottom: 0;
        }
        .meal-table th {
            background-color: #f8f9fa;
            border-top: none;
        }
        .meal-total {
            background-color: #f0f7ff;
            font-weight: bold;
        }
        .nutrition-summary {
            background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .nutrition-summary-item {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            margin-bottom: 10px;
        }
        .nutrition-summary-item h4 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        .nutrition-summary-item small {
            font-size: 14px;
            opacity: 0.8;
        }
        .content-container {
            padding-left: 80px;
            padding-right: 80px;
        }
        @media (max-width: 768px) {
            .content-container {
                padding-left: 40px;
                padding-right: 40px;
            }
        }
    </style>
{% endblock %}

{% block body %}
{% include 'navbar.html.twig' %}
<div class="container-fluid content-container" data-context="nutrition">
    <div class="d-flex justify-content-between align-items-center mb-4 mt-5">
        <h1 class="mb-0">Your Custom Nutrition Plan</h1>
        <div>
            <a href="{{ path('app_nutrition_preferences') }}" class="btn btn-primary">
                <i class="fas fa-arrow-left me-2"></i>Back to Preferences
            </a>
        </div>
    </div>

    {% for mealType, mealData in plan %}
        <div class="meal-card">
            <div class="card-header meal-header">
                <h2 class="h5 mb-0">{{ mealType|capitalize }}</h2>
            </div>
            <div class="card-body meal-body">
                <div class="table-responsive">
                    <table class="table table-sm meal-table">
                        <thead>
                            <tr>
                                <th>Food Item</th>
                                <th>Quantity</th>
                                <th>Calories</th>
                                <th>Protein</th>
                                <th>Carbs</th>
                                <th>Fat</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in mealData.items %}
                                <tr>
                                    <td>{{ item.name }}</td>
                                    <td>{{ item.quantity }}</td>
                                    <td>{{ item.calories }}</td>
                                    <td>{{ item.protein }}g</td>
                                    <td>{{ item.carbs }}g</td>
                                    <td>{{ item.fat }}g</td>
                                </tr>
                            {% endfor %}
                            <tr class="meal-total">
                                <td colspan="2"><strong>Total</strong></td>
                                <td><strong>{{ mealData.total.calories }}</strong></td>
                                <td><strong>{{ mealData.total.protein }}g</strong></td>
                                <td><strong>{{ mealData.total.carbs }}g</strong></td>
                                <td><strong>{{ mealData.total.fat }}g</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    {% endfor %}

    <div class="nutrition-summary">
        <div class="row">
            <div class="col-md-3">
                <div class="nutrition-summary-item">
                    <h4>{{ plan|reduce((sum, meal) => sum + meal.total.calories, 0) }}</h4>
                    <small>Total Calories</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="nutrition-summary-item">
                    <h4>{{ plan|reduce((sum, meal) => sum + meal.total.protein, 0) }}g</h4>
                    <small>Total Protein</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="nutrition-summary-item">
                    <h4>{{ plan|reduce((sum, meal) => sum + meal.total.carbs, 0) }}g</h4>
                    <small>Total Carbs</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="nutrition-summary-item">
                    <h4>{{ plan|reduce((sum, meal) => sum + meal.total.fat, 0) }}g</h4>
                    <small>Total Fat</small>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %} 