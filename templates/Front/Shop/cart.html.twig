{% extends 'base.html.twig' %}

{% block title %}My Cart{% endblock %}

{% block body %}
{% include 'navbar.html.twig' %}

<body data-context="shop" class="bg-light py-5">

<div class="container">
    <h1 class="text-center mb-5">Your Shopping Cart</h1>

    {% if cartItems is not empty %}
        <div class="table-responsive shadow rounded bg-white p-4">
            <table class="table table-bordered text-center">
                <thead>
    <tr>
        <th class="text-center">Product</th>
        <th class="text-center">Quantity</th>
        <th class="text-center">Action</th>
        <th class="text-center">Price</th> {# <-- NOW properly above Price column #}
    </tr>
</thead>

                <tbody>
                    {% for item in cartItems %}
                        <tr>
                            <td class="align-middle">
                                <img src="{{ item.product.imageUrl }}" class="img-thumbnail" style="width: 80px;">
                                <div class="mt-2 font-weight-bold">{{ item.product.name }}</div>
                            </td>
                            <td class="align-middle">
                                <div class="d-flex justify-content-center align-items-center">
                                    <a href="{{ path('cart_decrease', {'id': item.product.id}) }}" class="btn btn-sm btn-danger">-</a>
                                    <span class="mx-2">{{ item.quantity }}</span>
                                    <a href="{{ path('cart_increase', {'id': item.product.id}) }}" class="btn btn-sm btn-success">+</a>
                                </div>
                            </td>
                            <td class="align-middle">
                                <a href="{{ path('cart_remove', {'id': item.product.id}) }}" class="btn btn-sm btn-outline-danger">Remove</a>
                            </td>
                            <td class="align-middle font-weight-bold">
                                {{ (item.product.price * item.quantity)|number_format(2) }} USD
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="text-right font-weight-bold mt-4">
            <h4>Total: {{ total|number_format(2) }} USD</h4>
        </div>
        <div class="text-center mt-5">
            <form action="{{ path('checkout_start') }}" method="POST">
                <button type="submit" class="btn btn-success btn-lg">Proceed to Checkout</button>
            </form>
        </div>
    {% else %}
        <p class="text-center text-muted mt-4">Your cart is empty.</p>
    {% endif %}
</div>

</body>
{% endblock %}
